// Code generated by Speakeasy (https://speakeasy.com). DO NOT EDIT.

package components

import (
	"github.com/criblio/cribl-control-plane-sdk-go/internal/utils"
)

// RestCollectorConfDiscoverType - Defines how task discovery will be performed. Each entry returned by the Discover operation will result in a Collect task.
type RestCollectorConfDiscoverType string

const (
	RestCollectorConfDiscoverTypeHTTP RestCollectorConfDiscoverType = "http"
	RestCollectorConfDiscoverTypeJSON RestCollectorConfDiscoverType = "json"
	RestCollectorConfDiscoverTypeList RestCollectorConfDiscoverType = "list"
	RestCollectorConfDiscoverTypeNone RestCollectorConfDiscoverType = "none"
)

func (e RestCollectorConfDiscoverType) ToPointer() *RestCollectorConfDiscoverType {
	return &e
}

// IsExact returns true if the value matches a known enum value, false otherwise.
func (e *RestCollectorConfDiscoverType) IsExact() bool {
	if e != nil {
		switch *e {
		case "http", "json", "list", "none":
			return true
		}
	}
	return false
}

type RestCollectorConfDiscovery struct {
	// Defines how task discovery will be performed. Each entry returned by the Discover operation will result in a Collect task.
	DiscoverType *RestCollectorConfDiscoverType `default:"none" json:"discoverType"`
}

func (r RestCollectorConfDiscovery) MarshalJSON() ([]byte, error) {
	return utils.MarshalJSON(r, "", false)
}

func (r *RestCollectorConfDiscovery) UnmarshalJSON(data []byte) error {
	if err := utils.UnmarshalJSON(data, &r, "", false, nil); err != nil {
		return err
	}
	return nil
}

func (r *RestCollectorConfDiscovery) GetDiscoverType() *RestCollectorConfDiscoverType {
	if r == nil {
		return nil
	}
	return r.DiscoverType
}

type CollectMethod string

const (
	// CollectMethodGet GET
	CollectMethodGet CollectMethod = "get"
	// CollectMethodPost POST
	CollectMethodPost CollectMethod = "post"
	// CollectMethodPostWithBody POST with Body
	CollectMethodPostWithBody CollectMethod = "post_with_body"
	// CollectMethodOther Other
	CollectMethodOther CollectMethod = "other"
)

func (e CollectMethod) ToPointer() *CollectMethod {
	return &e
}

// IsExact returns true if the value matches a known enum value, false otherwise.
func (e *CollectMethod) IsExact() bool {
	if e != nil {
		switch *e {
		case "get", "post", "post_with_body", "other":
			return true
		}
	}
	return false
}

type RestCollectorConfCollectRequestHeader struct {
	Name string `json:"name"`
	// JavaScript expression to compute parameter value, usually enclosed in backticks (`${earliest}`). If a constant, use single quotes ('earliest'). Values that aren't successfully evaluated as JavaScript expressions will be treated as string constants.
	Value string `json:"value"`
}

func (r RestCollectorConfCollectRequestHeader) MarshalJSON() ([]byte, error) {
	return utils.MarshalJSON(r, "", false)
}

func (r *RestCollectorConfCollectRequestHeader) UnmarshalJSON(data []byte) error {
	if err := utils.UnmarshalJSON(data, &r, "", false, []string{"name", "value"}); err != nil {
		return err
	}
	return nil
}

func (r *RestCollectorConfCollectRequestHeader) GetName() string {
	if r == nil {
		return ""
	}
	return r.Name
}

func (r *RestCollectorConfCollectRequestHeader) GetValue() string {
	if r == nil {
		return ""
	}
	return r.Value
}

type PaginationEnum string

const (
	// PaginationEnumNone None
	PaginationEnumNone PaginationEnum = "none"
	// PaginationEnumResponseBody Response Body Attribute
	PaginationEnumResponseBody PaginationEnum = "response_body"
	// PaginationEnumResponseHeader Response Header Attribute
	PaginationEnumResponseHeader PaginationEnum = "response_header"
	// PaginationEnumResponseHeaderLink RFC 5988 - Web Linking
	PaginationEnumResponseHeaderLink PaginationEnum = "response_header_link"
	// PaginationEnumRequestOffset Offset/Limit
	PaginationEnumRequestOffset PaginationEnum = "request_offset"
	// PaginationEnumRequestPage Page/Size
	PaginationEnumRequestPage PaginationEnum = "request_page"
)

func (e PaginationEnum) ToPointer() *PaginationEnum {
	return &e
}

// IsExact returns true if the value matches a known enum value, false otherwise.
func (e *PaginationEnum) IsExact() bool {
	if e != nil {
		switch *e {
		case "none", "response_body", "response_header", "response_header_link", "request_offset", "request_page":
			return true
		}
	}
	return false
}

type Pagination struct {
	Type *PaginationEnum `default:"none" json:"type"`
}

func (p Pagination) MarshalJSON() ([]byte, error) {
	return utils.MarshalJSON(p, "", false)
}

func (p *Pagination) UnmarshalJSON(data []byte) error {
	if err := utils.UnmarshalJSON(data, &p, "", false, nil); err != nil {
		return err
	}
	return nil
}

func (p *Pagination) GetType() *PaginationEnum {
	if p == nil {
		return nil
	}
	return p.Type
}

// RestCollectorConfAuthentication - Authentication method for Discover and Collect REST calls. You can specify API key–based authentication by adding the appropriate Collect headers.
type RestCollectorConfAuthentication string

const (
	RestCollectorConfAuthenticationNone              RestCollectorConfAuthentication = "none"
	RestCollectorConfAuthenticationBasic             RestCollectorConfAuthentication = "basic"
	RestCollectorConfAuthenticationBasicSecret       RestCollectorConfAuthentication = "basicSecret"
	RestCollectorConfAuthenticationLogin             RestCollectorConfAuthentication = "login"
	RestCollectorConfAuthenticationLoginSecret       RestCollectorConfAuthentication = "loginSecret"
	RestCollectorConfAuthenticationOauth             RestCollectorConfAuthentication = "oauth"
	RestCollectorConfAuthenticationOauthSecret       RestCollectorConfAuthentication = "oauthSecret"
	RestCollectorConfAuthenticationGoogleOauth       RestCollectorConfAuthentication = "google_oauth"
	RestCollectorConfAuthenticationGoogleOauthSecret RestCollectorConfAuthentication = "google_oauthSecret"
	RestCollectorConfAuthenticationHmac              RestCollectorConfAuthentication = "hmac"
)

func (e RestCollectorConfAuthentication) ToPointer() *RestCollectorConfAuthentication {
	return &e
}

// IsExact returns true if the value matches a known enum value, false otherwise.
func (e *RestCollectorConfAuthentication) IsExact() bool {
	if e != nil {
		switch *e {
		case "none", "basic", "basicSecret", "login", "loginSecret", "oauth", "oauthSecret", "google_oauth", "google_oauthSecret", "hmac":
			return true
		}
	}
	return false
}

// RestCollectorConfRetryType - Algorithm to use when performing HTTP retries
type RestCollectorConfRetryType string

const (
	// RestCollectorConfRetryTypeNone Disabled
	RestCollectorConfRetryTypeNone RestCollectorConfRetryType = "none"
	// RestCollectorConfRetryTypeBackoff Backoff
	RestCollectorConfRetryTypeBackoff RestCollectorConfRetryType = "backoff"
	// RestCollectorConfRetryTypeStatic Static
	RestCollectorConfRetryTypeStatic RestCollectorConfRetryType = "static"
)

func (e RestCollectorConfRetryType) ToPointer() *RestCollectorConfRetryType {
	return &e
}

// IsExact returns true if the value matches a known enum value, false otherwise.
func (e *RestCollectorConfRetryType) IsExact() bool {
	if e != nil {
		switch *e {
		case "none", "backoff", "static":
			return true
		}
	}
	return false
}

type RestCollectorConfRetryRules struct {
	// Algorithm to use when performing HTTP retries
	Type                *RestCollectorConfRetryType `default:"backoff" json:"type"`
	Interval            any                         `json:"interval,omitempty"`
	Limit               any                         `json:"limit,omitempty"`
	Multiplier          any                         `json:"multiplier,omitempty"`
	MaxIntervalMs       any                         `json:"maxIntervalMs,omitempty"`
	Codes               any                         `json:"codes,omitempty"`
	EnableHeader        any                         `json:"enableHeader,omitempty"`
	RetryConnectTimeout any                         `json:"retryConnectTimeout,omitempty"`
	RetryConnectReset   any                         `json:"retryConnectReset,omitempty"`
}

func (r RestCollectorConfRetryRules) MarshalJSON() ([]byte, error) {
	return utils.MarshalJSON(r, "", false)
}

func (r *RestCollectorConfRetryRules) UnmarshalJSON(data []byte) error {
	if err := utils.UnmarshalJSON(data, &r, "", false, nil); err != nil {
		return err
	}
	return nil
}

func (r *RestCollectorConfRetryRules) GetType() *RestCollectorConfRetryType {
	if r == nil {
		return nil
	}
	return r.Type
}

func (r *RestCollectorConfRetryRules) GetInterval() any {
	if r == nil {
		return nil
	}
	return r.Interval
}

func (r *RestCollectorConfRetryRules) GetLimit() any {
	if r == nil {
		return nil
	}
	return r.Limit
}

func (r *RestCollectorConfRetryRules) GetMultiplier() any {
	if r == nil {
		return nil
	}
	return r.Multiplier
}

func (r *RestCollectorConfRetryRules) GetMaxIntervalMs() any {
	if r == nil {
		return nil
	}
	return r.MaxIntervalMs
}

func (r *RestCollectorConfRetryRules) GetCodes() any {
	if r == nil {
		return nil
	}
	return r.Codes
}

func (r *RestCollectorConfRetryRules) GetEnableHeader() any {
	if r == nil {
		return nil
	}
	return r.EnableHeader
}

func (r *RestCollectorConfRetryRules) GetRetryConnectTimeout() any {
	if r == nil {
		return nil
	}
	return r.RetryConnectTimeout
}

func (r *RestCollectorConfRetryRules) GetRetryConnectReset() any {
	if r == nil {
		return nil
	}
	return r.RetryConnectReset
}

type RestCollectorConfStateTracking struct {
	// Track collection progress between consecutive scheduled executions
	Enabled *bool `json:"enabled,omitempty"`
}

func (r RestCollectorConfStateTracking) MarshalJSON() ([]byte, error) {
	return utils.MarshalJSON(r, "", false)
}

func (r *RestCollectorConfStateTracking) UnmarshalJSON(data []byte) error {
	if err := utils.UnmarshalJSON(data, &r, "", false, nil); err != nil {
		return err
	}
	return nil
}

func (r *RestCollectorConfStateTracking) GetEnabled() *bool {
	if r == nil {
		return nil
	}
	return r.Enabled
}

type RestCollectorConfScheduling struct {
	StateTracking *RestCollectorConfStateTracking `json:"stateTracking,omitempty"`
}

func (r RestCollectorConfScheduling) MarshalJSON() ([]byte, error) {
	return utils.MarshalJSON(r, "", false)
}

func (r *RestCollectorConfScheduling) UnmarshalJSON(data []byte) error {
	if err := utils.UnmarshalJSON(data, &r, "", false, nil); err != nil {
		return err
	}
	return nil
}

func (r *RestCollectorConfScheduling) GetStateTracking() *RestCollectorConfStateTracking {
	if r == nil {
		return nil
	}
	return r.StateTracking
}

type RestCollectorConf struct {
	Discovery *RestCollectorConfDiscovery `json:"discovery,omitempty"`
	// URL (constant or JavaScript expression) to use for the Collect operation
	CollectURL            string                                  `json:"collectUrl"`
	CollectMethod         *CollectMethod                          `default:"get" json:"collectMethod"`
	CollectVerb           any                                     `json:"collectVerb,omitempty"`
	CollectRequestParams  any                                     `json:"collectRequestParams,omitempty"`
	CollectBody           any                                     `json:"collectBody,omitempty"`
	CollectRequestHeaders []RestCollectorConfCollectRequestHeader `json:"collectRequestHeaders,omitempty"`
	Pagination            *Pagination                             `json:"pagination,omitempty"`
	// Authentication method for Discover and Collect REST calls. You can specify API key–based authentication by adding the appropriate Collect headers.
	Authentication *RestCollectorConfAuthentication `default:"none" json:"authentication"`
	// HTTP request inactivity timeout. Use 0 to disable.
	Timeout *float64 `default:"0" json:"timeout"`
	// Use round-robin DNS lookup. Suitable when DNS server returns multiple addresses in sort order.
	UseRoundRobinDNS *bool `default:"false" json:"useRoundRobinDns"`
	// Disable Collector event time filtering when a date range is specified
	DisableTimeFilter *bool `default:"false" json:"disableTimeFilter"`
	// Decode the URL before sending requests (including pagination requests)
	DecodeURL *bool `default:"true" json:"decodeUrl"`
	// Reject certificates that cannot be verified against a valid CA (such as self-signed certificates)
	RejectUnauthorized *bool `default:"false" json:"rejectUnauthorized"`
	// Enable to add response headers to the resHeaders field under the __collectible object
	CaptureHeaders *bool `default:"false" json:"captureHeaders"`
	// Stop pagination when the Event Breaker produces no events
	StopOnEmptyResults *bool `default:"false" json:"stopOnEmptyResults"`
	// List of headers that are safe to log in plain text
	SafeHeaders []string                     `json:"safeHeaders,omitempty"`
	RetryRules  *RestCollectorConfRetryRules `json:"retryRules,omitempty"`
	Scheduling  *RestCollectorConfScheduling `json:"__scheduling,omitempty"`
}

func (r RestCollectorConf) MarshalJSON() ([]byte, error) {
	return utils.MarshalJSON(r, "", false)
}

func (r *RestCollectorConf) UnmarshalJSON(data []byte) error {
	if err := utils.UnmarshalJSON(data, &r, "", false, []string{"collectUrl"}); err != nil {
		return err
	}
	return nil
}

func (r *RestCollectorConf) GetDiscovery() *RestCollectorConfDiscovery {
	if r == nil {
		return nil
	}
	return r.Discovery
}

func (r *RestCollectorConf) GetCollectURL() string {
	if r == nil {
		return ""
	}
	return r.CollectURL
}

func (r *RestCollectorConf) GetCollectMethod() *CollectMethod {
	if r == nil {
		return nil
	}
	return r.CollectMethod
}

func (r *RestCollectorConf) GetCollectVerb() any {
	if r == nil {
		return nil
	}
	return r.CollectVerb
}

func (r *RestCollectorConf) GetCollectRequestParams() any {
	if r == nil {
		return nil
	}
	return r.CollectRequestParams
}

func (r *RestCollectorConf) GetCollectBody() any {
	if r == nil {
		return nil
	}
	return r.CollectBody
}

func (r *RestCollectorConf) GetCollectRequestHeaders() []RestCollectorConfCollectRequestHeader {
	if r == nil {
		return nil
	}
	return r.CollectRequestHeaders
}

func (r *RestCollectorConf) GetPagination() *Pagination {
	if r == nil {
		return nil
	}
	return r.Pagination
}

func (r *RestCollectorConf) GetAuthentication() *RestCollectorConfAuthentication {
	if r == nil {
		return nil
	}
	return r.Authentication
}

func (r *RestCollectorConf) GetTimeout() *float64 {
	if r == nil {
		return nil
	}
	return r.Timeout
}

func (r *RestCollectorConf) GetUseRoundRobinDNS() *bool {
	if r == nil {
		return nil
	}
	return r.UseRoundRobinDNS
}

func (r *RestCollectorConf) GetDisableTimeFilter() *bool {
	if r == nil {
		return nil
	}
	return r.DisableTimeFilter
}

func (r *RestCollectorConf) GetDecodeURL() *bool {
	if r == nil {
		return nil
	}
	return r.DecodeURL
}

func (r *RestCollectorConf) GetRejectUnauthorized() *bool {
	if r == nil {
		return nil
	}
	return r.RejectUnauthorized
}

func (r *RestCollectorConf) GetCaptureHeaders() *bool {
	if r == nil {
		return nil
	}
	return r.CaptureHeaders
}

func (r *RestCollectorConf) GetStopOnEmptyResults() *bool {
	if r == nil {
		return nil
	}
	return r.StopOnEmptyResults
}

func (r *RestCollectorConf) GetSafeHeaders() []string {
	if r == nil {
		return nil
	}
	return r.SafeHeaders
}

func (r *RestCollectorConf) GetRetryRules() *RestCollectorConfRetryRules {
	if r == nil {
		return nil
	}
	return r.RetryRules
}

func (r *RestCollectorConf) GetScheduling() *RestCollectorConfScheduling {
	if r == nil {
		return nil
	}
	return r.Scheduling
}

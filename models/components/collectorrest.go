// Code generated by Speakeasy (https://speakeasy.com). DO NOT EDIT.

package components

import (
	"encoding/json"
	"fmt"
	"github.com/criblio/cribl-control-plane-sdk-go/internal/utils"
)

// CollectorRestType - Collector type: rest
type CollectorRestType string

const (
	CollectorRestTypeRest CollectorRestType = "rest"
)

func (e CollectorRestType) ToPointer() *CollectorRestType {
	return &e
}
func (e *CollectorRestType) UnmarshalJSON(data []byte) error {
	var v string
	if err := json.Unmarshal(data, &v); err != nil {
		return err
	}
	switch v {
	case "rest":
		*e = CollectorRestType(v)
		return nil
	default:
		return fmt.Errorf("invalid value for CollectorRestType: %v", v)
	}
}

// CollectorRestDiscoverType - Defines how task discovery will be performed. Each entry returned by the Discover operation will result in a Collect task.
type CollectorRestDiscoverType string

const (
	CollectorRestDiscoverTypeHTTP CollectorRestDiscoverType = "http"
	CollectorRestDiscoverTypeJSON CollectorRestDiscoverType = "json"
	CollectorRestDiscoverTypeList CollectorRestDiscoverType = "list"
	CollectorRestDiscoverTypeNone CollectorRestDiscoverType = "none"
)

func (e CollectorRestDiscoverType) ToPointer() *CollectorRestDiscoverType {
	return &e
}

// IsExact returns true if the value matches a known enum value, false otherwise.
func (e *CollectorRestDiscoverType) IsExact() bool {
	if e != nil {
		switch *e {
		case "http", "json", "list", "none":
			return true
		}
	}
	return false
}

type CollectorRestDiscovery struct {
	// Defines how task discovery will be performed. Each entry returned by the Discover operation will result in a Collect task.
	DiscoverType *CollectorRestDiscoverType `default:"none" json:"discoverType"`
}

func (c CollectorRestDiscovery) MarshalJSON() ([]byte, error) {
	return utils.MarshalJSON(c, "", false)
}

func (c *CollectorRestDiscovery) UnmarshalJSON(data []byte) error {
	if err := utils.UnmarshalJSON(data, &c, "", false, nil); err != nil {
		return err
	}
	return nil
}

func (c *CollectorRestDiscovery) GetDiscoverType() *CollectorRestDiscoverType {
	if c == nil {
		return nil
	}
	return c.DiscoverType
}

type CollectMethod string

const (
	// CollectMethodGet GET
	CollectMethodGet CollectMethod = "get"
	// CollectMethodPost POST
	CollectMethodPost CollectMethod = "post"
	// CollectMethodPostWithBody POST with Body
	CollectMethodPostWithBody CollectMethod = "post_with_body"
	// CollectMethodOther Other
	CollectMethodOther CollectMethod = "other"
)

func (e CollectMethod) ToPointer() *CollectMethod {
	return &e
}

// IsExact returns true if the value matches a known enum value, false otherwise.
func (e *CollectMethod) IsExact() bool {
	if e != nil {
		switch *e {
		case "get", "post", "post_with_body", "other":
			return true
		}
	}
	return false
}

type CollectorRestCollectRequestHeader struct {
	Name string `json:"name"`
	// JavaScript expression to compute parameter value, usually enclosed in backticks (`${earliest}`). If a constant, use single quotes ('earliest'). Values that aren't successfully evaluated as JavaScript expressions will be treated as string constants.
	Value string `json:"value"`
}

func (c CollectorRestCollectRequestHeader) MarshalJSON() ([]byte, error) {
	return utils.MarshalJSON(c, "", false)
}

func (c *CollectorRestCollectRequestHeader) UnmarshalJSON(data []byte) error {
	if err := utils.UnmarshalJSON(data, &c, "", false, []string{"name", "value"}); err != nil {
		return err
	}
	return nil
}

func (c *CollectorRestCollectRequestHeader) GetName() string {
	if c == nil {
		return ""
	}
	return c.Name
}

func (c *CollectorRestCollectRequestHeader) GetValue() string {
	if c == nil {
		return ""
	}
	return c.Value
}

type PaginationEnum string

const (
	// PaginationEnumNone None
	PaginationEnumNone PaginationEnum = "none"
	// PaginationEnumResponseBody Response Body Attribute
	PaginationEnumResponseBody PaginationEnum = "response_body"
	// PaginationEnumResponseHeader Response Header Attribute
	PaginationEnumResponseHeader PaginationEnum = "response_header"
	// PaginationEnumResponseHeaderLink RFC 5988 - Web Linking
	PaginationEnumResponseHeaderLink PaginationEnum = "response_header_link"
	// PaginationEnumRequestOffset Offset/Limit
	PaginationEnumRequestOffset PaginationEnum = "request_offset"
	// PaginationEnumRequestPage Page/Size
	PaginationEnumRequestPage PaginationEnum = "request_page"
)

func (e PaginationEnum) ToPointer() *PaginationEnum {
	return &e
}

// IsExact returns true if the value matches a known enum value, false otherwise.
func (e *PaginationEnum) IsExact() bool {
	if e != nil {
		switch *e {
		case "none", "response_body", "response_header", "response_header_link", "request_offset", "request_page":
			return true
		}
	}
	return false
}

type Pagination struct {
	Type *PaginationEnum `default:"none" json:"type"`
}

func (p Pagination) MarshalJSON() ([]byte, error) {
	return utils.MarshalJSON(p, "", false)
}

func (p *Pagination) UnmarshalJSON(data []byte) error {
	if err := utils.UnmarshalJSON(data, &p, "", false, nil); err != nil {
		return err
	}
	return nil
}

func (p *Pagination) GetType() *PaginationEnum {
	if p == nil {
		return nil
	}
	return p.Type
}

// CollectorRestAuthentication - Authentication method for Discover and Collect REST calls. You can specify API key–based authentication by adding the appropriate Collect headers.
type CollectorRestAuthentication string

const (
	CollectorRestAuthenticationNone              CollectorRestAuthentication = "none"
	CollectorRestAuthenticationBasic             CollectorRestAuthentication = "basic"
	CollectorRestAuthenticationBasicSecret       CollectorRestAuthentication = "basicSecret"
	CollectorRestAuthenticationLogin             CollectorRestAuthentication = "login"
	CollectorRestAuthenticationLoginSecret       CollectorRestAuthentication = "loginSecret"
	CollectorRestAuthenticationOauth             CollectorRestAuthentication = "oauth"
	CollectorRestAuthenticationOauthSecret       CollectorRestAuthentication = "oauthSecret"
	CollectorRestAuthenticationGoogleOauth       CollectorRestAuthentication = "google_oauth"
	CollectorRestAuthenticationGoogleOauthSecret CollectorRestAuthentication = "google_oauthSecret"
	CollectorRestAuthenticationHmac              CollectorRestAuthentication = "hmac"
)

func (e CollectorRestAuthentication) ToPointer() *CollectorRestAuthentication {
	return &e
}

// IsExact returns true if the value matches a known enum value, false otherwise.
func (e *CollectorRestAuthentication) IsExact() bool {
	if e != nil {
		switch *e {
		case "none", "basic", "basicSecret", "login", "loginSecret", "oauth", "oauthSecret", "google_oauth", "google_oauthSecret", "hmac":
			return true
		}
	}
	return false
}

// CollectorRestRetryType - Algorithm to use when performing HTTP retries
type CollectorRestRetryType string

const (
	// CollectorRestRetryTypeNone Disabled
	CollectorRestRetryTypeNone CollectorRestRetryType = "none"
	// CollectorRestRetryTypeBackoff Backoff
	CollectorRestRetryTypeBackoff CollectorRestRetryType = "backoff"
	// CollectorRestRetryTypeStatic Static
	CollectorRestRetryTypeStatic CollectorRestRetryType = "static"
)

func (e CollectorRestRetryType) ToPointer() *CollectorRestRetryType {
	return &e
}

// IsExact returns true if the value matches a known enum value, false otherwise.
func (e *CollectorRestRetryType) IsExact() bool {
	if e != nil {
		switch *e {
		case "none", "backoff", "static":
			return true
		}
	}
	return false
}

type CollectorRestRetryRules struct {
	// Algorithm to use when performing HTTP retries
	Type                *CollectorRestRetryType `default:"backoff" json:"type"`
	Interval            any                     `json:"interval,omitempty"`
	Limit               any                     `json:"limit,omitempty"`
	Multiplier          any                     `json:"multiplier,omitempty"`
	MaxIntervalMs       any                     `json:"maxIntervalMs,omitempty"`
	Codes               any                     `json:"codes,omitempty"`
	EnableHeader        any                     `json:"enableHeader,omitempty"`
	RetryConnectTimeout any                     `json:"retryConnectTimeout,omitempty"`
	RetryConnectReset   any                     `json:"retryConnectReset,omitempty"`
}

func (c CollectorRestRetryRules) MarshalJSON() ([]byte, error) {
	return utils.MarshalJSON(c, "", false)
}

func (c *CollectorRestRetryRules) UnmarshalJSON(data []byte) error {
	if err := utils.UnmarshalJSON(data, &c, "", false, nil); err != nil {
		return err
	}
	return nil
}

func (c *CollectorRestRetryRules) GetType() *CollectorRestRetryType {
	if c == nil {
		return nil
	}
	return c.Type
}

func (c *CollectorRestRetryRules) GetInterval() any {
	if c == nil {
		return nil
	}
	return c.Interval
}

func (c *CollectorRestRetryRules) GetLimit() any {
	if c == nil {
		return nil
	}
	return c.Limit
}

func (c *CollectorRestRetryRules) GetMultiplier() any {
	if c == nil {
		return nil
	}
	return c.Multiplier
}

func (c *CollectorRestRetryRules) GetMaxIntervalMs() any {
	if c == nil {
		return nil
	}
	return c.MaxIntervalMs
}

func (c *CollectorRestRetryRules) GetCodes() any {
	if c == nil {
		return nil
	}
	return c.Codes
}

func (c *CollectorRestRetryRules) GetEnableHeader() any {
	if c == nil {
		return nil
	}
	return c.EnableHeader
}

func (c *CollectorRestRetryRules) GetRetryConnectTimeout() any {
	if c == nil {
		return nil
	}
	return c.RetryConnectTimeout
}

func (c *CollectorRestRetryRules) GetRetryConnectReset() any {
	if c == nil {
		return nil
	}
	return c.RetryConnectReset
}

type CollectorRestStateTracking struct {
	// Track collection progress between consecutive scheduled executions
	Enabled *bool `json:"enabled,omitempty"`
}

func (c CollectorRestStateTracking) MarshalJSON() ([]byte, error) {
	return utils.MarshalJSON(c, "", false)
}

func (c *CollectorRestStateTracking) UnmarshalJSON(data []byte) error {
	if err := utils.UnmarshalJSON(data, &c, "", false, nil); err != nil {
		return err
	}
	return nil
}

func (c *CollectorRestStateTracking) GetEnabled() *bool {
	if c == nil {
		return nil
	}
	return c.Enabled
}

type CollectorRestScheduling struct {
	StateTracking *CollectorRestStateTracking `json:"stateTracking,omitempty"`
}

func (c CollectorRestScheduling) MarshalJSON() ([]byte, error) {
	return utils.MarshalJSON(c, "", false)
}

func (c *CollectorRestScheduling) UnmarshalJSON(data []byte) error {
	if err := utils.UnmarshalJSON(data, &c, "", false, nil); err != nil {
		return err
	}
	return nil
}

func (c *CollectorRestScheduling) GetStateTracking() *CollectorRestStateTracking {
	if c == nil {
		return nil
	}
	return c.StateTracking
}

type CollectorRest struct {
	// Collector type: rest
	Type      CollectorRestType       `json:"type"`
	Discovery *CollectorRestDiscovery `json:"discovery,omitempty"`
	// URL (constant or JavaScript expression) to use for the Collect operation
	CollectURL            string                              `json:"collectUrl"`
	CollectMethod         *CollectMethod                      `default:"get" json:"collectMethod"`
	CollectVerb           any                                 `json:"collectVerb,omitempty"`
	CollectRequestParams  any                                 `json:"collectRequestParams,omitempty"`
	CollectBody           any                                 `json:"collectBody,omitempty"`
	CollectRequestHeaders []CollectorRestCollectRequestHeader `json:"collectRequestHeaders,omitempty"`
	Pagination            *Pagination                         `json:"pagination,omitempty"`
	// Authentication method for Discover and Collect REST calls. You can specify API key–based authentication by adding the appropriate Collect headers.
	Authentication *CollectorRestAuthentication `default:"none" json:"authentication"`
	// HTTP request inactivity timeout. Use 0 to disable.
	Timeout *float64 `default:"0" json:"timeout"`
	// Use round-robin DNS lookup. Suitable when DNS server returns multiple addresses in sort order.
	UseRoundRobinDNS *bool `default:"false" json:"useRoundRobinDns"`
	// Disable Collector event time filtering when a date range is specified
	DisableTimeFilter *bool `default:"false" json:"disableTimeFilter"`
	// Decode the URL before sending requests (including pagination requests)
	DecodeURL *bool `default:"true" json:"decodeUrl"`
	// Reject certificates that cannot be verified against a valid CA (such as self-signed certificates)
	RejectUnauthorized *bool `default:"false" json:"rejectUnauthorized"`
	// Enable to add response headers to the resHeaders field under the __collectible object
	CaptureHeaders *bool `default:"false" json:"captureHeaders"`
	// Stop pagination when the Event Breaker produces no events
	StopOnEmptyResults *bool `default:"false" json:"stopOnEmptyResults"`
	// List of headers that are safe to log in plain text
	SafeHeaders []string                 `json:"safeHeaders,omitempty"`
	RetryRules  *CollectorRestRetryRules `json:"retryRules,omitempty"`
	Scheduling  *CollectorRestScheduling `json:"__scheduling,omitempty"`
}

func (c CollectorRest) MarshalJSON() ([]byte, error) {
	return utils.MarshalJSON(c, "", false)
}

func (c *CollectorRest) UnmarshalJSON(data []byte) error {
	if err := utils.UnmarshalJSON(data, &c, "", false, []string{"type", "collectUrl"}); err != nil {
		return err
	}
	return nil
}

func (c *CollectorRest) GetType() CollectorRestType {
	if c == nil {
		return CollectorRestType("")
	}
	return c.Type
}

func (c *CollectorRest) GetDiscovery() *CollectorRestDiscovery {
	if c == nil {
		return nil
	}
	return c.Discovery
}

func (c *CollectorRest) GetCollectURL() string {
	if c == nil {
		return ""
	}
	return c.CollectURL
}

func (c *CollectorRest) GetCollectMethod() *CollectMethod {
	if c == nil {
		return nil
	}
	return c.CollectMethod
}

func (c *CollectorRest) GetCollectVerb() any {
	if c == nil {
		return nil
	}
	return c.CollectVerb
}

func (c *CollectorRest) GetCollectRequestParams() any {
	if c == nil {
		return nil
	}
	return c.CollectRequestParams
}

func (c *CollectorRest) GetCollectBody() any {
	if c == nil {
		return nil
	}
	return c.CollectBody
}

func (c *CollectorRest) GetCollectRequestHeaders() []CollectorRestCollectRequestHeader {
	if c == nil {
		return nil
	}
	return c.CollectRequestHeaders
}

func (c *CollectorRest) GetPagination() *Pagination {
	if c == nil {
		return nil
	}
	return c.Pagination
}

func (c *CollectorRest) GetAuthentication() *CollectorRestAuthentication {
	if c == nil {
		return nil
	}
	return c.Authentication
}

func (c *CollectorRest) GetTimeout() *float64 {
	if c == nil {
		return nil
	}
	return c.Timeout
}

func (c *CollectorRest) GetUseRoundRobinDNS() *bool {
	if c == nil {
		return nil
	}
	return c.UseRoundRobinDNS
}

func (c *CollectorRest) GetDisableTimeFilter() *bool {
	if c == nil {
		return nil
	}
	return c.DisableTimeFilter
}

func (c *CollectorRest) GetDecodeURL() *bool {
	if c == nil {
		return nil
	}
	return c.DecodeURL
}

func (c *CollectorRest) GetRejectUnauthorized() *bool {
	if c == nil {
		return nil
	}
	return c.RejectUnauthorized
}

func (c *CollectorRest) GetCaptureHeaders() *bool {
	if c == nil {
		return nil
	}
	return c.CaptureHeaders
}

func (c *CollectorRest) GetStopOnEmptyResults() *bool {
	if c == nil {
		return nil
	}
	return c.StopOnEmptyResults
}

func (c *CollectorRest) GetSafeHeaders() []string {
	if c == nil {
		return nil
	}
	return c.SafeHeaders
}

func (c *CollectorRest) GetRetryRules() *CollectorRestRetryRules {
	if c == nil {
		return nil
	}
	return c.RetryRules
}

func (c *CollectorRest) GetScheduling() *CollectorRestScheduling {
	if c == nil {
		return nil
	}
	return c.Scheduling
}

// Code generated by Speakeasy (https://speakeasy.com). DO NOT EDIT.

package components

import (
	"encoding/json"
	"errors"
	"fmt"
	"github.com/criblio/cribl-control-plane-sdk-go/internal/utils"
)

type CollectorConfType string

const (
	CollectorConfTypeAzureBlob          CollectorConfType = "azure_blob"
	CollectorConfTypeCriblLake          CollectorConfType = "cribl_lake"
	CollectorConfTypeDatabase           CollectorConfType = "database"
	CollectorConfTypeFilesystem         CollectorConfType = "filesystem"
	CollectorConfTypeGoogleCloudStorage CollectorConfType = "google_cloud_storage"
	CollectorConfTypeHealthCheck        CollectorConfType = "health_check"
	CollectorConfTypeRest               CollectorConfType = "rest"
	CollectorConfTypeS3                 CollectorConfType = "s3"
	CollectorConfTypeScript             CollectorConfType = "script"
	CollectorConfTypeSplunk             CollectorConfType = "splunk"
)

// CollectorConf - Collector configuration
type CollectorConf struct {
	CollectorAzureBlob          *CollectorAzureBlob          `queryParam:"inline,name=CollectorConf" union:"member"`
	CollectorCriblLake          *CollectorCriblLake          `queryParam:"inline,name=CollectorConf" union:"member"`
	CollectorDatabase           *CollectorDatabase           `queryParam:"inline,name=CollectorConf" union:"member"`
	CollectorFilesystem         *CollectorFilesystem         `queryParam:"inline,name=CollectorConf" union:"member"`
	CollectorGoogleCloudStorage *CollectorGoogleCloudStorage `queryParam:"inline,name=CollectorConf" union:"member"`
	CollectorHealthCheck        *CollectorHealthCheck        `queryParam:"inline,name=CollectorConf" union:"member"`
	CollectorRest               *CollectorRest               `queryParam:"inline,name=CollectorConf" union:"member"`
	CollectorS3                 *CollectorS3                 `queryParam:"inline,name=CollectorConf" union:"member"`
	CollectorScript             *CollectorScript             `queryParam:"inline,name=CollectorConf" union:"member"`
	CollectorSplunk             *CollectorSplunk             `queryParam:"inline,name=CollectorConf" union:"member"`

	Type CollectorConfType
}

func CreateCollectorConfAzureBlob(azureBlob CollectorAzureBlob) CollectorConf {
	typ := CollectorConfTypeAzureBlob

	return CollectorConf{
		CollectorAzureBlob: &azureBlob,
		Type:               typ,
	}
}

func CreateCollectorConfCriblLake(criblLake CollectorCriblLake) CollectorConf {
	typ := CollectorConfTypeCriblLake

	typStr := CollectorCriblLakeType(typ)
	criblLake.Type = typStr

	return CollectorConf{
		CollectorCriblLake: &criblLake,
		Type:               typ,
	}
}

func CreateCollectorConfDatabase(database CollectorDatabase) CollectorConf {
	typ := CollectorConfTypeDatabase

	typStr := CollectorDatabaseType(typ)
	database.Type = typStr

	return CollectorConf{
		CollectorDatabase: &database,
		Type:              typ,
	}
}

func CreateCollectorConfFilesystem(filesystem CollectorFilesystem) CollectorConf {
	typ := CollectorConfTypeFilesystem

	typStr := CollectorFilesystemType(typ)
	filesystem.Type = typStr

	return CollectorConf{
		CollectorFilesystem: &filesystem,
		Type:                typ,
	}
}

func CreateCollectorConfGoogleCloudStorage(googleCloudStorage CollectorGoogleCloudStorage) CollectorConf {
	typ := CollectorConfTypeGoogleCloudStorage

	return CollectorConf{
		CollectorGoogleCloudStorage: &googleCloudStorage,
		Type:                        typ,
	}
}

func CreateCollectorConfHealthCheck(healthCheck CollectorHealthCheck) CollectorConf {
	typ := CollectorConfTypeHealthCheck

	return CollectorConf{
		CollectorHealthCheck: &healthCheck,
		Type:                 typ,
	}
}

func CreateCollectorConfRest(rest CollectorRest) CollectorConf {
	typ := CollectorConfTypeRest

	return CollectorConf{
		CollectorRest: &rest,
		Type:          typ,
	}
}

func CreateCollectorConfS3(s3 CollectorS3) CollectorConf {
	typ := CollectorConfTypeS3

	return CollectorConf{
		CollectorS3: &s3,
		Type:        typ,
	}
}

func CreateCollectorConfScript(script CollectorScript) CollectorConf {
	typ := CollectorConfTypeScript

	typStr := CollectorScriptType(typ)
	script.Type = typStr

	return CollectorConf{
		CollectorScript: &script,
		Type:            typ,
	}
}

func CreateCollectorConfSplunk(splunk CollectorSplunk) CollectorConf {
	typ := CollectorConfTypeSplunk

	return CollectorConf{
		CollectorSplunk: &splunk,
		Type:            typ,
	}
}

func (u *CollectorConf) UnmarshalJSON(data []byte) error {

	type discriminator struct {
		Type string `json:"type"`
	}

	dis := new(discriminator)
	if err := json.Unmarshal(data, &dis); err != nil {
		return fmt.Errorf("could not unmarshal discriminator: %w", err)
	}

	switch dis.Type {
	case "azure_blob":
		collectorAzureBlob := new(CollectorAzureBlob)
		if err := utils.UnmarshalJSON(data, &collectorAzureBlob, "", true, nil); err != nil {
			return fmt.Errorf("could not unmarshal `%s` into expected (Type == azure_blob) type CollectorAzureBlob within CollectorConf: %w", string(data), err)
		}

		u.CollectorAzureBlob = collectorAzureBlob
		u.Type = CollectorConfTypeAzureBlob
		return nil
	case "cribl_lake":
		collectorCriblLake := new(CollectorCriblLake)
		if err := utils.UnmarshalJSON(data, &collectorCriblLake, "", true, nil); err != nil {
			return fmt.Errorf("could not unmarshal `%s` into expected (Type == cribl_lake) type CollectorCriblLake within CollectorConf: %w", string(data), err)
		}

		u.CollectorCriblLake = collectorCriblLake
		u.Type = CollectorConfTypeCriblLake
		return nil
	case "database":
		collectorDatabase := new(CollectorDatabase)
		if err := utils.UnmarshalJSON(data, &collectorDatabase, "", true, nil); err != nil {
			return fmt.Errorf("could not unmarshal `%s` into expected (Type == database) type CollectorDatabase within CollectorConf: %w", string(data), err)
		}

		u.CollectorDatabase = collectorDatabase
		u.Type = CollectorConfTypeDatabase
		return nil
	case "filesystem":
		collectorFilesystem := new(CollectorFilesystem)
		if err := utils.UnmarshalJSON(data, &collectorFilesystem, "", true, nil); err != nil {
			return fmt.Errorf("could not unmarshal `%s` into expected (Type == filesystem) type CollectorFilesystem within CollectorConf: %w", string(data), err)
		}

		u.CollectorFilesystem = collectorFilesystem
		u.Type = CollectorConfTypeFilesystem
		return nil
	case "google_cloud_storage":
		collectorGoogleCloudStorage := new(CollectorGoogleCloudStorage)
		if err := utils.UnmarshalJSON(data, &collectorGoogleCloudStorage, "", true, nil); err != nil {
			return fmt.Errorf("could not unmarshal `%s` into expected (Type == google_cloud_storage) type CollectorGoogleCloudStorage within CollectorConf: %w", string(data), err)
		}

		u.CollectorGoogleCloudStorage = collectorGoogleCloudStorage
		u.Type = CollectorConfTypeGoogleCloudStorage
		return nil
	case "health_check":
		collectorHealthCheck := new(CollectorHealthCheck)
		if err := utils.UnmarshalJSON(data, &collectorHealthCheck, "", true, nil); err != nil {
			return fmt.Errorf("could not unmarshal `%s` into expected (Type == health_check) type CollectorHealthCheck within CollectorConf: %w", string(data), err)
		}

		u.CollectorHealthCheck = collectorHealthCheck
		u.Type = CollectorConfTypeHealthCheck
		return nil
	case "rest":
		collectorRest := new(CollectorRest)
		if err := utils.UnmarshalJSON(data, &collectorRest, "", true, nil); err != nil {
			return fmt.Errorf("could not unmarshal `%s` into expected (Type == rest) type CollectorRest within CollectorConf: %w", string(data), err)
		}

		u.CollectorRest = collectorRest
		u.Type = CollectorConfTypeRest
		return nil
	case "s3":
		collectorS3 := new(CollectorS3)
		if err := utils.UnmarshalJSON(data, &collectorS3, "", true, nil); err != nil {
			return fmt.Errorf("could not unmarshal `%s` into expected (Type == s3) type CollectorS3 within CollectorConf: %w", string(data), err)
		}

		u.CollectorS3 = collectorS3
		u.Type = CollectorConfTypeS3
		return nil
	case "script":
		collectorScript := new(CollectorScript)
		if err := utils.UnmarshalJSON(data, &collectorScript, "", true, nil); err != nil {
			return fmt.Errorf("could not unmarshal `%s` into expected (Type == script) type CollectorScript within CollectorConf: %w", string(data), err)
		}

		u.CollectorScript = collectorScript
		u.Type = CollectorConfTypeScript
		return nil
	case "splunk":
		collectorSplunk := new(CollectorSplunk)
		if err := utils.UnmarshalJSON(data, &collectorSplunk, "", true, nil); err != nil {
			return fmt.Errorf("could not unmarshal `%s` into expected (Type == splunk) type CollectorSplunk within CollectorConf: %w", string(data), err)
		}

		u.CollectorSplunk = collectorSplunk
		u.Type = CollectorConfTypeSplunk
		return nil
	}

	return fmt.Errorf("could not unmarshal `%s` into any supported union types for CollectorConf", string(data))
}

func (u CollectorConf) MarshalJSON() ([]byte, error) {
	if u.CollectorAzureBlob != nil {
		return utils.MarshalJSON(u.CollectorAzureBlob, "", true)
	}

	if u.CollectorCriblLake != nil {
		return utils.MarshalJSON(u.CollectorCriblLake, "", true)
	}

	if u.CollectorDatabase != nil {
		return utils.MarshalJSON(u.CollectorDatabase, "", true)
	}

	if u.CollectorFilesystem != nil {
		return utils.MarshalJSON(u.CollectorFilesystem, "", true)
	}

	if u.CollectorGoogleCloudStorage != nil {
		return utils.MarshalJSON(u.CollectorGoogleCloudStorage, "", true)
	}

	if u.CollectorHealthCheck != nil {
		return utils.MarshalJSON(u.CollectorHealthCheck, "", true)
	}

	if u.CollectorRest != nil {
		return utils.MarshalJSON(u.CollectorRest, "", true)
	}

	if u.CollectorS3 != nil {
		return utils.MarshalJSON(u.CollectorS3, "", true)
	}

	if u.CollectorScript != nil {
		return utils.MarshalJSON(u.CollectorScript, "", true)
	}

	if u.CollectorSplunk != nil {
		return utils.MarshalJSON(u.CollectorSplunk, "", true)
	}

	return nil, errors.New("could not marshal union type CollectorConf: all fields are null")
}

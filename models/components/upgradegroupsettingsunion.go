// Code generated by Speakeasy (https://speakeasy.com). DO NOT EDIT.

package components

import (
	"errors"
	"fmt"
	"github.com/criblio/cribl-control-plane-sdk-go/internal/utils"
)

type UpgradeGroupSettings2 struct {
}

func (u UpgradeGroupSettings2) MarshalJSON() ([]byte, error) {
	return utils.MarshalJSON(u, "", false)
}

func (u *UpgradeGroupSettings2) UnmarshalJSON(data []byte) error {
	if err := utils.UnmarshalJSON(data, &u, "", false, nil); err != nil {
		return err
	}
	return nil
}

type UpgradeGroupSettings1 struct {
	IsRolling  *bool    `json:"isRolling,omitzero"`
	Quantity   *float64 `json:"quantity,omitzero"`
	RetryCount *float64 `json:"retryCount,omitzero"`
	RetryDelay *float64 `json:"retryDelay,omitzero"`
}

func (u UpgradeGroupSettings1) MarshalJSON() ([]byte, error) {
	return utils.MarshalJSON(u, "", false)
}

func (u *UpgradeGroupSettings1) UnmarshalJSON(data []byte) error {
	if err := utils.UnmarshalJSON(data, &u, "", false, nil); err != nil {
		return err
	}
	return nil
}

func (u *UpgradeGroupSettings1) GetIsRolling() *bool {
	if u == nil {
		return nil
	}
	return u.IsRolling
}

func (u *UpgradeGroupSettings1) GetQuantity() *float64 {
	if u == nil {
		return nil
	}
	return u.Quantity
}

func (u *UpgradeGroupSettings1) GetRetryCount() *float64 {
	if u == nil {
		return nil
	}
	return u.RetryCount
}

func (u *UpgradeGroupSettings1) GetRetryDelay() *float64 {
	if u == nil {
		return nil
	}
	return u.RetryDelay
}

type UpgradeGroupSettingsUnionType string

const (
	UpgradeGroupSettingsUnionTypeUpgradeGroupSettings1 UpgradeGroupSettingsUnionType = "UpgradeGroupSettings_1"
	UpgradeGroupSettingsUnionTypeUpgradeGroupSettings2 UpgradeGroupSettingsUnionType = "UpgradeGroupSettings_2"
)

type UpgradeGroupSettingsUnion struct {
	UpgradeGroupSettings1 *UpgradeGroupSettings1 `queryParam:"inline" union:"member"`
	UpgradeGroupSettings2 *UpgradeGroupSettings2 `queryParam:"inline" union:"member"`

	Type UpgradeGroupSettingsUnionType
}

func CreateUpgradeGroupSettingsUnionUpgradeGroupSettings1(upgradeGroupSettings1 UpgradeGroupSettings1) UpgradeGroupSettingsUnion {
	typ := UpgradeGroupSettingsUnionTypeUpgradeGroupSettings1

	return UpgradeGroupSettingsUnion{
		UpgradeGroupSettings1: &upgradeGroupSettings1,
		Type:                  typ,
	}
}

func CreateUpgradeGroupSettingsUnionUpgradeGroupSettings2(upgradeGroupSettings2 UpgradeGroupSettings2) UpgradeGroupSettingsUnion {
	typ := UpgradeGroupSettingsUnionTypeUpgradeGroupSettings2

	return UpgradeGroupSettingsUnion{
		UpgradeGroupSettings2: &upgradeGroupSettings2,
		Type:                  typ,
	}
}

func (u *UpgradeGroupSettingsUnion) UnmarshalJSON(data []byte) error {

	var candidates []utils.UnionCandidate

	// Collect all valid candidates
	var upgradeGroupSettings1 UpgradeGroupSettings1 = UpgradeGroupSettings1{}
	if err := utils.UnmarshalJSON(data, &upgradeGroupSettings1, "", true, nil); err == nil {
		candidates = append(candidates, utils.UnionCandidate{
			Type:  UpgradeGroupSettingsUnionTypeUpgradeGroupSettings1,
			Value: &upgradeGroupSettings1,
		})
	}

	var upgradeGroupSettings2 UpgradeGroupSettings2 = UpgradeGroupSettings2{}
	if err := utils.UnmarshalJSON(data, &upgradeGroupSettings2, "", true, nil); err == nil {
		candidates = append(candidates, utils.UnionCandidate{
			Type:  UpgradeGroupSettingsUnionTypeUpgradeGroupSettings2,
			Value: &upgradeGroupSettings2,
		})
	}

	if len(candidates) == 0 {
		return fmt.Errorf("could not unmarshal `%s` into any supported union types for UpgradeGroupSettingsUnion", string(data))
	}

	// Pick the best candidate using multi-stage filtering
	best := utils.PickBestUnionCandidate(candidates, data)
	if best == nil {
		return fmt.Errorf("could not unmarshal `%s` into any supported union types for UpgradeGroupSettingsUnion", string(data))
	}

	// Set the union type and value based on the best candidate
	u.Type = best.Type.(UpgradeGroupSettingsUnionType)
	switch best.Type {
	case UpgradeGroupSettingsUnionTypeUpgradeGroupSettings1:
		u.UpgradeGroupSettings1 = best.Value.(*UpgradeGroupSettings1)
		return nil
	case UpgradeGroupSettingsUnionTypeUpgradeGroupSettings2:
		u.UpgradeGroupSettings2 = best.Value.(*UpgradeGroupSettings2)
		return nil
	}

	return fmt.Errorf("could not unmarshal `%s` into any supported union types for UpgradeGroupSettingsUnion", string(data))
}

func (u UpgradeGroupSettingsUnion) MarshalJSON() ([]byte, error) {
	if u.UpgradeGroupSettings1 != nil {
		return utils.MarshalJSON(u.UpgradeGroupSettings1, "", true)
	}

	if u.UpgradeGroupSettings2 != nil {
		return utils.MarshalJSON(u.UpgradeGroupSettings2, "", true)
	}

	return nil, errors.New("could not marshal union type UpgradeGroupSettingsUnion: all fields are null")
}

// Code generated by Speakeasy (https://speakeasy.com). DO NOT EDIT.

package components

import (
	"encoding/json"
	"errors"
	"fmt"
	"github.com/criblio/cribl-control-plane-sdk-go/internal/utils"
)

type CollectorType string

const (
	CollectorTypeAzureBlob          CollectorType = "azure_blob"
	CollectorTypeCriblLake          CollectorType = "cribl_lake"
	CollectorTypeDatabase           CollectorType = "database"
	CollectorTypeFilesystem         CollectorType = "filesystem"
	CollectorTypeGoogleCloudStorage CollectorType = "google_cloud_storage"
	CollectorTypeHealthCheck        CollectorType = "health_check"
	CollectorTypeRest               CollectorType = "rest"
	CollectorTypeS3                 CollectorType = "s3"
	CollectorTypeScript             CollectorType = "script"
	CollectorTypeSplunk             CollectorType = "splunk"
	CollectorTypeUnknown            CollectorType = "UNKNOWN"
)

// Collector configuration
type Collector struct {
	CollectorAzureBlob          *CollectorAzureBlob          `queryParam:"inline" union:"member"`
	CollectorCriblLake          *CollectorCriblLake          `queryParam:"inline" union:"member"`
	CollectorDatabase           *CollectorDatabase           `queryParam:"inline" union:"member"`
	CollectorFilesystem         *CollectorFilesystem         `queryParam:"inline" union:"member"`
	CollectorGoogleCloudStorage *CollectorGoogleCloudStorage `queryParam:"inline" union:"member"`
	CollectorHealthCheck        *CollectorHealthCheck        `queryParam:"inline" union:"member"`
	CollectorRest               *CollectorRest               `queryParam:"inline" union:"member"`
	CollectorS3                 *CollectorS3                 `queryParam:"inline" union:"member"`
	CollectorScript             *CollectorScript             `queryParam:"inline" union:"member"`
	CollectorSplunk             *CollectorSplunk             `queryParam:"inline" union:"member"`
	UnknownRaw                  json.RawMessage              `json:"-" union:"unknown"`

	Type CollectorType
}

func CreateCollectorAzureBlob(azureBlob CollectorAzureBlob) Collector {
	typ := CollectorTypeAzureBlob

	typStr := CollectorAzureBlobType(typ)
	azureBlob.Type = typStr

	return Collector{
		CollectorAzureBlob: &azureBlob,
		Type:               typ,
	}
}

func CreateCollectorCriblLake(criblLake CollectorCriblLake) Collector {
	typ := CollectorTypeCriblLake

	typStr := CollectorCriblLakeType(typ)
	criblLake.Type = typStr

	return Collector{
		CollectorCriblLake: &criblLake,
		Type:               typ,
	}
}

func CreateCollectorDatabase(database CollectorDatabase) Collector {
	typ := CollectorTypeDatabase

	typStr := CollectorDatabaseType(typ)
	database.Type = typStr

	return Collector{
		CollectorDatabase: &database,
		Type:              typ,
	}
}

func CreateCollectorFilesystem(filesystem CollectorFilesystem) Collector {
	typ := CollectorTypeFilesystem

	typStr := CollectorFilesystemType(typ)
	filesystem.Type = typStr

	return Collector{
		CollectorFilesystem: &filesystem,
		Type:                typ,
	}
}

func CreateCollectorGoogleCloudStorage(googleCloudStorage CollectorGoogleCloudStorage) Collector {
	typ := CollectorTypeGoogleCloudStorage

	typStr := CollectorGoogleCloudStorageType(typ)
	googleCloudStorage.Type = typStr

	return Collector{
		CollectorGoogleCloudStorage: &googleCloudStorage,
		Type:                        typ,
	}
}

func CreateCollectorHealthCheck(healthCheck CollectorHealthCheck) Collector {
	typ := CollectorTypeHealthCheck

	typStr := CollectorHealthCheckType(typ)
	healthCheck.Type = typStr

	return Collector{
		CollectorHealthCheck: &healthCheck,
		Type:                 typ,
	}
}

func CreateCollectorRest(rest CollectorRest) Collector {
	typ := CollectorTypeRest

	typStr := CollectorRestType(typ)
	rest.Type = typStr

	return Collector{
		CollectorRest: &rest,
		Type:          typ,
	}
}

func CreateCollectorS3(s3 CollectorS3) Collector {
	typ := CollectorTypeS3

	typStr := CollectorS3Type(typ)
	s3.Type = typStr

	return Collector{
		CollectorS3: &s3,
		Type:        typ,
	}
}

func CreateCollectorScript(script CollectorScript) Collector {
	typ := CollectorTypeScript

	typStr := CollectorScriptType(typ)
	script.Type = typStr

	return Collector{
		CollectorScript: &script,
		Type:            typ,
	}
}

func CreateCollectorSplunk(splunk CollectorSplunk) Collector {
	typ := CollectorTypeSplunk

	typStr := CollectorSplunkType(typ)
	splunk.Type = typStr

	return Collector{
		CollectorSplunk: &splunk,
		Type:            typ,
	}
}

func CreateCollectorUnknown(raw json.RawMessage) Collector {
	return Collector{
		UnknownRaw: raw,
		Type:       CollectorTypeUnknown,
	}
}

func (u Collector) GetUnknownRaw() json.RawMessage {
	return u.UnknownRaw
}

func (u Collector) IsUnknown() bool {
	return u.Type == CollectorTypeUnknown
}

func (u *Collector) UnmarshalJSON(data []byte) error {

	type discriminator struct {
		Type string `json:"type"`
	}

	dis := new(discriminator)
	if err := json.Unmarshal(data, &dis); err != nil {
		u.UnknownRaw = json.RawMessage(data)
		u.Type = CollectorTypeUnknown
		return nil
	}
	if dis == nil {
		u.UnknownRaw = json.RawMessage(data)
		u.Type = CollectorTypeUnknown
		return nil
	}

	switch dis.Type {
	case "azure_blob":
		collectorAzureBlob := new(CollectorAzureBlob)
		if err := utils.UnmarshalJSON(data, &collectorAzureBlob, "", true, nil); err != nil {
			return fmt.Errorf("could not unmarshal `%s` into expected (Type == azure_blob) type CollectorAzureBlob within Collector: %w", string(data), err)
		}

		u.CollectorAzureBlob = collectorAzureBlob
		u.Type = CollectorTypeAzureBlob
		return nil
	case "cribl_lake":
		collectorCriblLake := new(CollectorCriblLake)
		if err := utils.UnmarshalJSON(data, &collectorCriblLake, "", true, nil); err != nil {
			return fmt.Errorf("could not unmarshal `%s` into expected (Type == cribl_lake) type CollectorCriblLake within Collector: %w", string(data), err)
		}

		u.CollectorCriblLake = collectorCriblLake
		u.Type = CollectorTypeCriblLake
		return nil
	case "database":
		collectorDatabase := new(CollectorDatabase)
		if err := utils.UnmarshalJSON(data, &collectorDatabase, "", true, nil); err != nil {
			return fmt.Errorf("could not unmarshal `%s` into expected (Type == database) type CollectorDatabase within Collector: %w", string(data), err)
		}

		u.CollectorDatabase = collectorDatabase
		u.Type = CollectorTypeDatabase
		return nil
	case "filesystem":
		collectorFilesystem := new(CollectorFilesystem)
		if err := utils.UnmarshalJSON(data, &collectorFilesystem, "", true, nil); err != nil {
			return fmt.Errorf("could not unmarshal `%s` into expected (Type == filesystem) type CollectorFilesystem within Collector: %w", string(data), err)
		}

		u.CollectorFilesystem = collectorFilesystem
		u.Type = CollectorTypeFilesystem
		return nil
	case "google_cloud_storage":
		collectorGoogleCloudStorage := new(CollectorGoogleCloudStorage)
		if err := utils.UnmarshalJSON(data, &collectorGoogleCloudStorage, "", true, nil); err != nil {
			return fmt.Errorf("could not unmarshal `%s` into expected (Type == google_cloud_storage) type CollectorGoogleCloudStorage within Collector: %w", string(data), err)
		}

		u.CollectorGoogleCloudStorage = collectorGoogleCloudStorage
		u.Type = CollectorTypeGoogleCloudStorage
		return nil
	case "health_check":
		collectorHealthCheck := new(CollectorHealthCheck)
		if err := utils.UnmarshalJSON(data, &collectorHealthCheck, "", true, nil); err != nil {
			return fmt.Errorf("could not unmarshal `%s` into expected (Type == health_check) type CollectorHealthCheck within Collector: %w", string(data), err)
		}

		u.CollectorHealthCheck = collectorHealthCheck
		u.Type = CollectorTypeHealthCheck
		return nil
	case "rest":
		collectorRest := new(CollectorRest)
		if err := utils.UnmarshalJSON(data, &collectorRest, "", true, nil); err != nil {
			return fmt.Errorf("could not unmarshal `%s` into expected (Type == rest) type CollectorRest within Collector: %w", string(data), err)
		}

		u.CollectorRest = collectorRest
		u.Type = CollectorTypeRest
		return nil
	case "s3":
		collectorS3 := new(CollectorS3)
		if err := utils.UnmarshalJSON(data, &collectorS3, "", true, nil); err != nil {
			return fmt.Errorf("could not unmarshal `%s` into expected (Type == s3) type CollectorS3 within Collector: %w", string(data), err)
		}

		u.CollectorS3 = collectorS3
		u.Type = CollectorTypeS3
		return nil
	case "script":
		collectorScript := new(CollectorScript)
		if err := utils.UnmarshalJSON(data, &collectorScript, "", true, nil); err != nil {
			return fmt.Errorf("could not unmarshal `%s` into expected (Type == script) type CollectorScript within Collector: %w", string(data), err)
		}

		u.CollectorScript = collectorScript
		u.Type = CollectorTypeScript
		return nil
	case "splunk":
		collectorSplunk := new(CollectorSplunk)
		if err := utils.UnmarshalJSON(data, &collectorSplunk, "", true, nil); err != nil {
			return fmt.Errorf("could not unmarshal `%s` into expected (Type == splunk) type CollectorSplunk within Collector: %w", string(data), err)
		}

		u.CollectorSplunk = collectorSplunk
		u.Type = CollectorTypeSplunk
		return nil
	default:
		u.UnknownRaw = json.RawMessage(data)
		u.Type = CollectorTypeUnknown
		return nil
	}

}

func (u Collector) MarshalJSON() ([]byte, error) {
	if u.CollectorAzureBlob != nil {
		return utils.MarshalJSON(u.CollectorAzureBlob, "", true)
	}

	if u.CollectorCriblLake != nil {
		return utils.MarshalJSON(u.CollectorCriblLake, "", true)
	}

	if u.CollectorDatabase != nil {
		return utils.MarshalJSON(u.CollectorDatabase, "", true)
	}

	if u.CollectorFilesystem != nil {
		return utils.MarshalJSON(u.CollectorFilesystem, "", true)
	}

	if u.CollectorGoogleCloudStorage != nil {
		return utils.MarshalJSON(u.CollectorGoogleCloudStorage, "", true)
	}

	if u.CollectorHealthCheck != nil {
		return utils.MarshalJSON(u.CollectorHealthCheck, "", true)
	}

	if u.CollectorRest != nil {
		return utils.MarshalJSON(u.CollectorRest, "", true)
	}

	if u.CollectorS3 != nil {
		return utils.MarshalJSON(u.CollectorS3, "", true)
	}

	if u.CollectorScript != nil {
		return utils.MarshalJSON(u.CollectorScript, "", true)
	}

	if u.CollectorSplunk != nil {
		return utils.MarshalJSON(u.CollectorSplunk, "", true)
	}

	if u.UnknownRaw != nil {
		return json.RawMessage(u.UnknownRaw), nil
	}
	return nil, errors.New("could not marshal union type Collector: all fields are null")
}
